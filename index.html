<!DOCTYPE html>
<html lang="en">

<head>
  <title>Excel Diffchecker</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/main.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
</head>

<body>
<nav class="navbar navbar-expand-sm" id="navbar">
  <div class="container-fluid">
    <img class="navbar-brand" src="assets/logo.png">
    
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">

          
      </ul>
    </div>
  </div>
</nav>

<div class="row" id="title">
    <div class="col-md-6">
        <h4 style="padding-bottom: 1cm;">Original Spreadsheet</h4>
        <input type="file" id="input1">
    </div>
    <div class="col-md-6">
        <h4 style="padding-bottom: 1cm;">Changed Spreadsheet</h4>
        <input type="file" id="input2">
</div>

<div class="row">
    <div class="col-sm-12">
    <table id="tbl-data"> </table>
    </div>
</div>


<div class="row">
<div class="col-sm-12">
    <table id="tbl-data2"> </table>
</div>
</div>




<ul id="myList"></ul>

<script>
    var arr1 = [];
    var arr2 = [];
       var input = document.getElementById('input1');
     input.addEventListener('change', function(){
         readXlsxFile(input.files[0]).then(function(data){
             var i = 0;
             data.map((row, index) => {
 
                 if(i==0) {
 
                 let table = document.getElementById('tbl-data'); 
                 
                 
                 generateTableHead (table, row);
                 window.arr1.push(row);
                 
                 
                
 
                 }
 
                 if(i>0) {
 
                 let table = document.getElementById('tbl-data');
                 
                 generateTableRows (table, row);
                 window.arr1.push(row);
                 
                 
                 
                 }
                 i++;
             });
         
             
         });
         
 
     });
     
 
 
     function generateTableHead(table, data) {
     let thead = table.createTHead();
     let row = thead.insertRow(); for(let key of data) {
     let th= document.createElement('th');
     let text= document.createTextNode(key);
     th.appendChild(text);
     row.appendChild(th);
     }
 }
     function generateTableRows(table, data) {
     let newRow = table.insertRow(-1);
     data.map((row, index) => {
     let newCell = newRow.insertCell();
     let newText = document.createTextNode(row);
     newCell.appendChild(newText);
     
 });


 
     }
 
 </script>
    
        
        
        
        <script>
        var input2 = document.getElementById('input2');
        input2.addEventListener('change', function(){
            readXlsxFile(input2.files[0]).then(function(data){
                var i = 0;
                data.map((row, index) => {
    
                    if(i==0) {
    
                    let table = document.getElementById('tbl-data2'); 
                    generateTableHead (table, row);
                    window.arr2.push(row);
    
                    }
    
                    if(i>0) {
    
                    let table = document.getElementById('tbl-data2'); 
                    generateTableRows (table, row);
                    window.arr2.push(row);
                    
                    }
                    i++;
                    
                });
                Diffchecker();
            });
    
        });
    
    
        function generateTableHead(table, data) {
        let thead = table.createTHead();
        let row = thead.insertRow(); for(let key of data) {
        let th= document.createElement('th');
        let text= document.createTextNode(key);
        th.appendChild(text);
        row.appendChild(th);
        }
    }
        function generateTableRows(table, data) {
        let newRow = table.insertRow(-1);
        data.map((row, index) => {
        let newCell = newRow.insertCell();
        let newText = document.createTextNode(row);
        newCell.appendChild(newText);
        
    });
        }
    </script>




<script>

    function Diffchecker(){
        var arr3 = [];
        var arr4 = [];
    
        for (let i = 0; i < arr1.length; i++) {
            
            for(let j = 0; j < arr1[i].length; j++){
    
                arr3.push(arr1[i][j]);
                    
              
            }
    
    
        }
    
        for (let k = 0; k < arr2.length; k++) {
            
            for(let l = 0; l < arr2[k].length; l++){
    
                arr4.push(arr2[k][l]);
                    
              
            }
    
        }
        var diff = [];
        for (let m = 0; m < arr4.length; m++) {
            if(m<arr3.length){
                
                if(arr3[m] != arr4[m]){
                        diff.push(arr4[m]);
                }     
            }
        }

        let list = document.getElementById("myList");
 
        diff.forEach((item) => {
            let li = document.createElement("li");
            li.innerText = item;
            list.appendChild(li);
        });
    } 
</script>
</body>
</html>



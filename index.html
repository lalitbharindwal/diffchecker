<!DOCTYPE html>
<html lang="en">

<head>
  <title>Excel Diffchecker</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/main.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
</head>

<body>
<nav class="navbar navbar-expand-sm" id="navbar">
  <div class="container-fluid">
    <img class="navbar-brand" src="assets/logo.png">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">

          
      </ul>
    </div>
  </div>
</nav>

<div class="row" id="title">
    <div class="col-sm-4">Original Spreadsheet</div>
    <div class="col-sm-4"></div>
    <div class="col-sm-4">Changed Spreadsheet</div>
</div>


<div class="row" id="title">
    <div class="col-sm-4"><input type="file" id="input1">
    </div>
    <div class="col-sm-4"><button onclick="">Check Difference</button></div>
    <div class="col-sm-4"><input type="file" id="input2">
</div>

<div class="row" id="textarea1">
    <div class="col-sm-12">
    <table id="tbl-data"></table>
    </div>
</div>


<div class="row" id="textarea2">
<div class="col-sm-12">
    <table id="tbl-data2"> </table>
</div>
</div>

<div class="row" id="title2">
    <div class="col-sm-6">
        <script>
         var input = document.getElementById('input1');
        input.addEventListener('change', function(){
            readXlsxFile(input.files[0]).then(function(data){
                var i = 0;
                data.map((row, index) => {
    
                    if(i==0) {
    
                    let table = document.getElementById('tbl-data'); 
                    
                    
                    generateTableHead (table, row);
                    
    
                    }
    
                    if(i>0) {
    
                    let table = document.getElementById('tbl-data');
                    
                    generateTableRows (table, row);
                    }
                    i++;
                });
            
                table.reset()
            });
            
    
        });
        
    
    
        function generateTableHead(table, data) {
        let thead = table.createTHead();
        let row = thead.insertRow(); for(let key of data) {
        let th= document.createElement('th');
        let text= document.createTextNode(key);
        th.appendChild(text);
        row.appendChild(th);
        }
    }
        function generateTableRows(table, data) {
        let newRow = table.insertRow(-1);
        data.map((row, index) => {
        let newCell = newRow.insertCell();
        let newText = document.createTextNode(row);
        newCell.appendChild(newText);
        
    });

   
    
        }
    
    </script></div>
   
    <div class="col-sm-6"><script>
        var input2 = document.getElementById('input2');
        input2.addEventListener('change', function(){
            readXlsxFile(input2.files[0]).then(function(data){
                var i = 0;
                data.map((row, index) => {
    
                    if(i==0) {
    
                    let table = document.getElementById('tbl-data2'); 
                    generateTableHead (table, row);
    
                    }
    
                    if(i>0) {
    
                    let table = document.getElementById('tbl-data2'); 
                    generateTableRows (table, row);
                    }
                    i++;
                });
            });
    
        });
    
    
        function generateTableHead(table, data) {
        let thead = table.createTHead();
        let row = thead.insertRow(); for(let key of data) {
        let th= document.createElement('th');
        let text= document.createTextNode(key);
        th.appendChild(text);
        row.appendChild(th);
        }
    }
        function generateTableRows(table, data) {
        let newRow = table.insertRow(-1);
        data.map((row, index) => {
        let newCell = newRow.insertCell();
        let newText = document.createTextNode(row);
        newCell.appendChild(newText);
        
    });
        }
    
    </script></div>
</div>











</body>
</html>


